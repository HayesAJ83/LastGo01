<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        
        <!-- Page Title -->
        <title>Surgical Names</title>

        <!-- Favicons -->
        <link rel="apple-touch-icon" sizes="180x180" href="/static/assets/img/favicons/apple-touch-icon.png">
        <link rel="icon" type="image/png" sizes="32x32" href="/static/assets/img/favicons/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/static/assets/img/favicons/favicon-16x16.png">
        <link rel="manifest" href="/static/assets/img/favicons/site.webmanifest">
        <link rel="mask-icon" href="/static/assets/img/favicons/safari-pinned-tab.svg" color="#f23838">
        <meta name="msapplication-TileColor" content="#da532c">
        <meta name="theme-color" content="#ffffff">

        <!-- Vendor Stylesheets -->
        <link href="https://fonts.googleapis.com/css?family=Oswald:300,400,500,700%7CRoboto:300,400,700" rel="stylesheet">
        <link href="/static/assets/vendor/material-design-iconic-font/dist/css/material-design-iconic-font.min.css" rel="stylesheet">
        <link href="/static/assets/vendor/@fortawesome/fontawesome-free/css/all.min.css" rel="stylesheet">
        <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">

        <!-- Font Awesome -->
        <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css" rel="stylesheet"/>
        <!-- Google Fonts -->
        <link href="https://fonts.googleapis.com/css?family=Oswald:300,400,500,700%7CRoboto:300,400,700" rel="stylesheet">
        <!-- MDB -->
        <link href="https://cdnjs.cloudflare.com/ajax/libs/mdb-ui-kit/3.3.0/mdb.min.css" rel="stylesheet"/>

        <!--Plugin CSS file with desired skin-->
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ion-rangeslider/2.3.1/css/ion.rangeSlider.min.css"/>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css" integrity="undefined" crossorigin="anonymous">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tail.select@0.5.15/css/bootstrap4/tail.select-default.css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/gitbrent/bootstrap4-toggle@3.6.1/css/bootstrap4-toggle.min.css">
        
        <!-- Global site tag (gtag.js) - Google Analytics -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=UA-129313359-1"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());

            gtag('config', 'UA-129313359-1');
        </script>

  
        <!-- Theme Stylesheets -->
        <link href="/static/assets/css/theme.css" rel="stylesheet">

        <script src="https://bossanova.uk/jspreadsheet/v4/jexcel.js"></script>
        <link rel="stylesheet" href="https://bossanova.uk/jspreadsheet/v4/jexcel.css" type="text/css" />
 
        <link rel="stylesheet" href="https://jsuites.net/v4/jsuites.css" type="text/css" />

        <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
        <link href="https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.14/dist/css/bootstrap-select.min.css" rel="stylesheet"/>

        <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet">


        <!-- Mapbox -->
        <link href="https://api.mapbox.com/mapbox-gl-js/v2.5.1/mapbox-gl.css" rel="stylesheet">
        <script src="https://api.mapbox.com/mapbox-gl-js/v2.5.1/mapbox-gl.js"></script>
        <link href="https://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet"/>
        <script src="https://api.tiles.mapbox.com/mapbox-gl-js/v2.5.1/mapbox-gl.js"></script>
        <link href="https://api.tiles.mapbox.com/mapbox-gl-js/v2.5.1/mapbox-gl.css" rel="stylesheet"/>
        
        <!-- Load the `mapbox-gl-geocoder` plugin. -->
        <script src="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v4.7.2/mapbox-gl-geocoder.min.js"></script>
        <link rel="stylesheet" href="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v4.7.2/mapbox-gl-geocoder.css" type="text/css">


        <style>
            body { margin: 0; padding: 0; }
            #map { position: absolute; top: 0; right: 0; bottom: 0; left: 0; margin: auto; }
            
            .mapboxgl-popup-content {
                text-align: center;
                font-family: 'Open Sans', sans-serif;
                }
        </style>

    </head>


    <body>
        <!-- Preloader -->
        <div class="preloader">
            <div class="row align-items-center text-center">
                <div class="col">
                    <h1 class="text-danger mb-2 fs-3" style="height:50px"><br><br><br>Loading...</h1>
                </div>
            </div>
            <div class="spinner">
                <div class="circles"></div>
            </div>
        </div>
        <!-- End of Preloader -->

        <!-- Header -->
        <header class="spyre-navbar navbar navbar-expand-lg bg-secondary navbar-dark fixed-top align-items-center" data-transparent data-text-color="#ffffff">
            <div class="container">
                <a class="navbar-brand mr-lg-5 mr-xl-7" href="{{ url_for('.index', _anchor='section-4') }}">
                    <img src="/static/assets/img/EponymExplorer3.jpg" class="d-none d-lg-block" alt="" width="183" />
                    <img src="/static/assets/img/EponymExplorer3.jpg" class="d-block d-lg-none" alt="" width="150" />
                </a>
            </div>
        </header>
        <!-- End of Header -->

        <!-- Main Content -->
        <main class="main minh-100vh">
            <!-- Section -->
            <section class="py-0 overflow-hidden text-center" id="section-1">
                <div class="bg-container overlay parallax" data-rellax-percentage="0.5" style="background-image: url(/static/assets/img/backgrounds/iStock-1202864734_map.jpg)"></div>
                <div class="container">
                    <div class="row h-100vh justify-content-center align-items-center">
                        <div class="col">
                            <p class="mb-5 fs-3 text-white text-uppercase font-weight-bold" data-aos="fade-down" data-aos-duration="1500"><br>Search<br>- World Maps -</p>
                            <p class="mb-5 fs-1 text-white" data-aos="zoom-in" data-aos-delay="100"><b>Find eponym definitions, history, photos,<br>references & weblinks</b></p>
                            <p></p>
                            <a href="http://www.www.surgicalnames.com/maps" class='btn btn-light' role='button'>refresh</a>
                        </div>
                    </div>
                </div>
            </section>
            <!-- End of Section -->


            <!-- Section -->
            <section id="section-2" class="pt-7 pb-0 bg-blue-light">
                <div class="container">
                    <div class="row align-items-center text-center">
                        <div class="col" data-aos="fade-up" id="select3">
                            <h1 class="text-black mb-2 fs-1" style="height:30px">Countries</h1>
                            <select id="sel" class="selectpicker show-tick"
                                    data-style="btn-primary" data-header="Search list:" 
                                    data-width="325px" data-size="6"
                                    data-aos="zoom-in"
                                    data-container="body"
                                    data-live-search="true";">
                                    <option value=""> -- select -- </option>
                            </select>
                            <p></p>
                            <p></p>
                            <p></p>
                        </div>
                    </div>
                </div>
                <p></p>
                <p></p>
                <hr style="height:1px; visibility:hidden">
                <form method="POST">
                    <div class="row align-items-center text-center">
                        <div class="col" data-aos="fade-up" id="select5" style="display:none"> <!--works-->
                            <h1 class="text-black mb-2 fs-1" style="height:30px">Eponyms</h1>
                            <select id="sel9" class="selectpicker show-tick"
                                    data-style="btn-primary" data-header="Search list:" 
                                    data-width="325px" data-size="6"
                                    data-aos="zoom-in"
                                    data-container="body"
                                    data-live-search="true" onchange="show2(this.value);">
                                    <option value=""> -- select -- </option>
                            </select>
                        </div>
                    </div>
                </form>
                <div class="row align-items-center text-center" id='blurb'>
                    <div class="lead" id='imgName2'></div>
                    <p class="lead" id="msg2"></p>
                    <p class="lead" id="msg3"></p>
                </div>
                <br>
                <br>
                <br>
            </section>
            <!-- End of Section -->

            <!-- Section -->     
            <section class="py-6 py-lg-6 bg-primary" id="section-3">
                <div class="container" style="height:400px">
                    <div class="row align-items-center text-center">
                        <div id="map" style="width: 98%; height:92%;">
                    </div>
                </div>
            </section>
            <!-- End of Section -->

        </main>
        <!-- End of Main Content -->


        <!-- Footer -->
        <footer class="footer text-white" style="background-image: url(/static/assets/img/backgrounds/iStock-532331964_op.jpg)">
            <div class="container d-flex h-100">
                <div class="row flex-grow-1">
                    <div class="col d-flex flex-column mb-2 mt-3">
                        <div class="row justify-content-center">
                            <div class="col-auto">
                                <a href="#section-1" class="btn btn-secondary" data-aos="zoom-in" data-aos-delay="20" data-aos-duration="500" data-smooth-scroll data-smooth-scroll-hash="false">back to top</a>
                            </div>
                        </div>
                        <div class="col-6 col-lg-3">
                            <h6 class="mb-1 mb-lg-4 text-uppercase"></h6> <!--About-->
                            <ul class="pt-2 mb-5 fw-light list-unstyled">
                                <li class="my-1"><a href="" class="text-white"></a></li> <!--Design Team-->
                                <li class="my-1"><a href="" class="text-white"></a></li> <!--Contact Us-->
                            </ul>
                        </div>
                        <div class="mt-auto d-flex justify-content-between">
                            <span class="fs--3 fs-lg--2">  &copy; 2021 SurgicalNames.com | Excision Ltd, Scotland, UK</span>
                        </div>
                    </div>
                </div>
            </div>
        </footer>
        <!-- End of Footer -->

        <!-- Javascripts -->
        <script src="https://code.jquery.com/jquery-3.3.1.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js" integrity="undefined" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/tail.select@0.5.15/js/tail.select-full.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/rellax@1.12.1/rellax.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap-select@1.13.14/dist/js/bootstrap-select.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
        <script>
            // Accepts any class name
            var rellax = new Rellax('.rellax');
        </script>

        <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
        <script>
            AOS.init();
        </script>

        <!--Plugin JavaScript file-->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/ion-rangeslider/2.3.1/js/ion.rangeSlider.min.js"></script>   
        <script src="https://cdn.jsdelivr.net/gh/gitbrent/bootstrap4-toggle@3.6.1/js/bootstrap4-toggle.min.js"></script>
        <script src="https://jsuites.net/v4/jsuites.js"></script>

        <!-- Load d3.js -->
        <script src="https://d3js.org/d3.v4.js"></script>


        <script>
            const eponyms = {
                'type': 'FeatureCollection',
                'features': [
        {   
            type:'Feature',
            ID: 1, 
            name:"Aaron sign",                 
            topic:["General Surgery"],
            subtype:["Signs"],                  
            who:"Charles Dettie Aaron", 
            whoSearch:["Charles D Aaron",],          
            where:"Detroit - Michigan - USA", 
            whereSearch:["Detroit, Michigan, USA", "Michigan, USA", "USA"], 
            country:["USA"], when:"1913",
            disease:["Abdominal pain","Appendicitis",],  
            ops:["Appendicectomy",], 
            opsSpec: {'General Surgery': ['Appendicectomy',] },
            geometry: {type: 'MultiPoint', coordinates: [ [ -83.0571, 42.35211], [10.0, 40.0], [40.0, 30.0] ] },  //lng,lat
            properties: {title:'Aaron sign', description:'Detroit<br>1913'},
            googlehtz:1400, //search: "Aaron sign" AND "Appendicitis" [02-Oct-21]
            refs:"<br><p style='font-size: 20px'>Aaron CD. A sign indicative of chronic appendicitis. <i>JAMA</i>. 1913; 60(5): 350-351</p>",    
            jrnls:["JAMA",],
            imgName:"",// no clear copyright source for image <br><img src=\"../static/assets/img/profiles/Charles_Dettie_Aaron.png\" class=\"card-img\" style=\"width:12rem;\">",
            about:"<br><p style='font-size: 20px'>Aaron's sign, indicitive of chronic appendicitis, is demonstrated by prolonged firm pressure at McBurney's point which produces pain in the epigastric region. <br>In Aaron's 1913 paper, he describes his findings in four patients.<br></p>", 
            acknow:"",//<br><i>We kindly acknowledge Miss XX FRCS who contributed the above information.</i>",
            URLs:"<br><a href='https://jamanetwork.com/journals/jama/article-abstract/214191' target='_blank' class='btn btn-secondary' role='button'>Original Paper</a> <a href='https://en.wikipedia.org/wiki/Aaron%27s_sign' target='_blank' class='btn btn-info' role='button'>Wikipedia</a> <a href='http://www.whonamedit.com/synd.cfm/341.html' target='_blank' class='btn btn-light' role='button'>Whonamedit?</a> <br>", 
        //},{
            //type:'Feature',
            //ID: 3, 
            //name:"Achilles tendon",      
            //topic:["Orthopaedics",], 
            //subtype:["Anatomy",], 
            //who:"Achilles", //whoSearch:["Achilles",],    
            //where:"", //whereSearch:["",],           
            //when:"1693",   
            //disease:["",],
            //ops:["",],
            //opsSpec: {'Orthopaedics':'',},
            //geometry: {type: 'Point', coordinates: [   ,  ]}, //lng,lat
            //properties: { title:"Achilles tendon", description:' <br> '},
            //googlehtz:0, //search: " " AND " " [02-Oct-21]
            //refs:"",   
            //jrnls:"",
            //URLs:"<br><a href='https://en.wikipedia.org/wiki/Achilles_tendon' target='_blank' class='btn btn-info' role='button'>wikipedia</a><br>",
            //imgName:"<br><img src=\"../static/assets/img/profiles/.png\" class=\"card-img\" style=\"width:12rem;\">", //temporary replacement
            //about:"<br>Named after the mythological Greek hero, Achilles, of the Trojan War.<br>", 
            //acknow:"",//<br><i>We kindly acknowledge Miss XX FRCS who contributed the above information.</i>",    
        },{
            type:'Feature',
            ID:8, 
            name:"Akamizu's criteria",      
            topic:["Endocrine",], 
            subtype:["Scores",], 
            who:"Takashi Akamizu", whoSearch:["Takashi Akamizu",],    
            where:"Wakayama - Japan", whereSearch:["Japan",],           
            country:["Japan"], when:"2012",   
            disease:["Thyrotoxicosis",],
            ops:["Thyroidectomy",],
            opsSpec: {'Endocrine':['Thyroidectomy',] },
            geometry: {type: 'MultiPoint', coordinates: [ 135.1824, 34.18827 ]}, //lng,lat
            properties: { title:"Akamizu's criteria", description:'Wakayama Medical University<br>2012'},
            googlehtz:5160, //search: "akamizu" AND "criteria" AND "thyroid storm" [20-Dec-21]
            refs:"<br><p style='font-size: 20px'>Akamizu T, Satoh T, Isozaki O, et al. Diagnostic criteria, clinical features, and incidence of thyroid storm based on nationwide surveys. <i>Thyroid</i>. 2012; 22(7): 661-679</p>",   
            jrnls:["Thyroid",], 
            URLs:"<br><a href='https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3387770/pdf/thy.2011.0334.pdf' target='_blank' class='btn btn-secondary' role='button'>Original Paper</a><br>",
            imgName:"",// Alive - contact him to ask for picture "<br><img src=\"../static/assets/img/profiles/.png\" class=\"card-img\" style=\"width:12rem;\">", //temporary replacement
            about:"<br><b><p style='font-size: 20px'>Akamizu's criteria refers to clinical features required for the diagnosis of a thyroid storm (TS)</b>.<br><br>The signs and symptoms are divided into central nervous system (CNS) manifestations and those that are not. The non-CNS signs and symptoms are <b>fever</b>, <b>tachycardia</b> (>130 bpm), <b>cardiac failure</b>, & <b>gastrointestinal-liver disturbance</b>.<br><br>A <b>definite thyrotoxic storm</b> requires elevation in blood thyroid hormone levels plus either: <br>1 feature of CNS disturbace + 1 non-CNS feature, <br><i>or</i> <br>3 non-CNS manifestations.<br><br>A <b>suspected thyrotoxic storm</b> requires the same criteria as those for defininte TS with the exception that there are no thyroid hormone results available, or there is no history of thyroid disease, exophthalmos or goitre.</p>", 
            acknow:"",//<br><i>We kindly acknowledge Miss XX FRCS who contributed the above information.</i>",    
        },{ 
            type:'Feature',
            ID: 10, 
            name:"Artery of Adamkiewicz",      
            topic:["Vascular", "Neurosurgery", "Radiology",], 
            subtype:["Anatomy",], 
            who:"Albert Wojciech Adamkiewicz", whoSearch:["Albert W Adamkiewicz",],   
            where:"Kraków - Poland", whereSearch:["Kraków, Poland", "Poland",],                   
            country:["Poland"], when:"1881",
            disease:["Spinal cord injury", "Paralysis",],
            ops:["AAA repair","Aortic surgery",],
            opsSpec: {'Vascular': ["AAA repair", "Aortic surgery",] },
            geometry: {type: 'MultiPoint', coordinates: [ 19.93482 , 50.06114 ]}, //lng,lat
            properties: {title:'Artery of Adamkiewicz', description:'Kraków<br>1881'},
            googlehtz:35500, //search: "Artery of Adamkiewicz" [20-Dec-21]
            refs:"",  
            jrnls:"",//["",]
            imgName:"<br><img src=\"../static/assets/img/profiles/Adamkiewicz.png\" class=\"card-img\" style=\"width:12rem;\">",
            about:"<br><p style='font-size: 20px'>The artery of Adamkiewicz is known by other terms, including arteria radicularis magna. This vessel is a major contributor to the anterior spinal artery which gives arterial supply to the lumbar and sacral cord and nerves.<br>The artery of Adamkiewicz arises from intercostal arteries which branch from the thoraco-abdominal aorta.</p>", 
            acknow:"<hr class='my-4'><p style='font-size: 16px'><i>The image shown of Adamkiewicz is in the Public Domain and was sourced from Wikipedia.</i></p>",
            URLs:"<br><a href='https://en.wikipedia.org/wiki/Artery_of_Adamkiewicz' target='_blank' class='btn btn-info' role='button'>Wikipedia</a><br>",    
        },{
            type:'Feature',
            ID: 15, 
            name:"Addison's disease",      
            topic:["Endocrine",], 
            subtype:["Pathology",], 
            who:"Thomas Addison", //whoSearch:[" ",],    
            where:"London - UK", whereSearch:["London",], 
            country:["UK"], when:"1855",   
            disease:["Adrenal insufficiency","Shock","Vomiting","Coma",],
            ops:["Adrenalectomy",],
            opsSpec: {'Endocrine': ["Adrenalectomy",] },
            geometry: {type: 'MultiPoint', coordinates: [ -0.08691, 51.50318 ]}, //lng,lat
            properties: { title:"Addison's disease", description:"Guy's Hospital - London<br>1855"},
            //googlehtz:0, //search: " " AND " " [02-Oct-21]
            refs:"<br><p style='font-size: 20px'>Addison T. On the constitutional and local effects of disease of the supra-adrenal capsules. London : Samuel Highley, 1855</p>",   
            jrnls:"",//["",]
            URLs:"<br><a href='https://wellcomecollection.org/works/xsmzqpdw/items?canvas=1' target='_blank' class='btn btn-secondary' role='button'>Original Textbook</a> <a href='https://en.wikipedia.org/wiki/Addison%27s_disease' target='_blank' class='btn btn-info' role='button'>Wikipedia</a> <br>", //https://archive.org/details/b21298786/page/n1/mode/2up
            imgName:"<br><img src=\"../static/assets/img/profiles/Addison_Thomas.jpg\" class=\"card-img\" style=\"width:12rem;\">", //temporary replacement
            about:"", 
            acknow:"<hr class='my-4'><p style='font-size: 16px'><i>The image of Addison was sourced from Wikipedia and is licenced under <a href='https://creativecommons.org/licenses/by/4.0/' target='_blank'>CC BY 4.0</a>.<i></p>",   
              
            }]}
        </script>




        <script>
            $(document)
            .ready(function() {
            const returnedData = $.grep(eponyms.features, function(element, index) {
                return (element.country !== "");
                });  /// DROP those WITHOUT OPERATIONS
            let result1 = returnedData
                .flatMap(item => item.topic) //"item.topic" gives us SPECIALTIES
                .filter((item, i, arr) => arr.indexOf(item) === i)
                .filter(el => {return el != null && el != '' && el != ' ' && el != "" && el != " ";}); //removes no topic
                let resultsort1 = result1.sort()
                var select = document.getElementById("select1");
                var options = resultsort1;
                for(var i = 0; i < options.length; i++) {
                    var opt = options[i];
                    var el = document.createElement("option");
                    el.textContent = opt;
                    el.value = opt;
                    select.appendChild(el);
                    }
            //console.log()   /// This gives us array with all features - when select1 is changed
            });
        </script>

        <script>
            $(document)
            .ready(function() {
            const returnedData = $.grep(eponyms.features, function(element, index) {
                return (element.country !== "");
                });  /// DROP those WITHOUT country
            let result1 = returnedData
                .flatMap(item => item.country) //"item.country" gives us country
                .filter((item, i, arr) => arr.indexOf(item) === i)
                .filter(el => {return el != null && el != '' && el != ' ' && el != "" && el != " ";}); //removes no ops
                let resultDis = result1.sort()
                var selectDis = document.getElementById("sel");
                var optionS = resultDis;
                for(var i = 0; i < optionS.length; i++) {
                    var opt1 = optionS[i];
                    var el1 = document.createElement("option");
                    el1.textContent = opt1;
                    el1.value = opt1;
                    selectDis.appendChild(el1);
                    }
            });

            $(document)
            .ready(function() {
                $('#select1').ready(function() {
                    let value = '\'' + $('#select1 option').map(function() {
                            return this.text}).get().join('\',\'') + '\'';
                    var stringArray = (new Function("return [" + value + "];")());
                });
            });   /// Generates all the select1 [specialties] options (eg. 'COLORECTAL')

            let select ="";
            $("#select1").find('option:selected').each(function() {
                    select += "\'" + $.trim($(this).text()) + "\',";});
                    if(select != ""){select = select.substr(0);};
                var stringArray = (new Function("return [" + select + "];")());
                
            function topicFilter2(taxonomy) {
                const returnedData = $.grep(eponyms.features, function(element, index) {
                    return (element.disease !== "");
                    });  /// DROP those WITHOUT OPERATIONS
                taxonomy = Array.isArray(taxonomy) ? taxonomy : [taxonomy];
                return returnedData.filter(item => {
                    let topic = Array.isArray(item.topic) ? item.topic : [item.topic];
                    return taxonomy.some(med => topic.includes(med));
                    });
                }
                    
            var selected2 = topicFilter2(stringArray); 
            console.log(selected2) //gives array of selected specialties eg. [ "Anaesthetics", "Trauma" ]

        </script>

        <script> 
            /// ALL - specialties
            /// THIS WORKS FINE
            $('#sel').on('change', function() {
                $('#select5').fadeIn(50);
                let select ="";
                $("#sel").find('option:selected').each(function() {
                    select += "\'" + $.trim($(this).text()) + "\',";});
                    if(select != ""){select = select.substr(0);};
                var stringArray = (new Function("return [" + select + "];")());
                console.log(stringArray); //works Array [chosen options]
                
                function topicFilter2(taxonomy) {
                    const returnedData = $.grep(eponyms.features, function(element, index) {
                        return (element.country !== "");
                        });  /// DROP those WITHOUT OPERATIONS
                    taxonomy = Array.isArray(taxonomy) ? taxonomy : [taxonomy];
                    return returnedData.filter(item => {
                        let country = Array.isArray(item.country) ? item.country : [item.country];
                        return taxonomy.some(med => country.includes(med));
                        });
                    }
                
                var selected2 = topicFilter2(stringArray); //works for stringArray no brackets
                console.log(selected2)

                function populateSelect2() {
                    document.getElementById('sel9').innerHTML = selected2.reduce((options, {ID,name}) =>
                        options += `<option value="${ID}">${name}</option>`,
                        '<option value=""> -- select -- </option>'
                        );
                    }
            
                populateSelect2()
                $('#sel9').selectpicker('refresh');
                $('#sel').on('change', function() {
                    $('#sel').selectpicker('toggle'); //added to toggle open/close
                    $('#sel9').selectpicker('refresh');
                    });
            });
        </script>

        <script>

            function show(id) {   
                var imgName = document.getElementById('imgName');
                if (!id) {imgName.innerHTML = "";
                } else {
                    for (var i = 0; i < eponyms.features.length; i++) {
                    if  (Number(id) === eponyms.features[i].ID) {
                        imgName.innerHTML = eponyms.features[i].imgName
                                                ;}}}
                                            $('.imgName').fadeIn('slow');

                var info = document.getElementById('info');
                if (!id) {imgName.innerHTML = "";
                } else {
                    for (var i = 0; i < eponyms.features.length; i++) {
                    if  (Number(id) === eponyms.features[i].ID) {
                        info.innerHTML =    "<br>"+
                                            eponyms.features[i].who.bold()   +"<br>"+
                                            eponyms.features[i].when.bold()  +"<br>"+
                                            eponyms.features[i].where.bold() +"<br><br>"+
                                            eponyms.features[i].about +
                                            eponyms.features[i].refs +
                                            eponyms.features[i].URLs +
                                            eponyms.features[i].acknow
                                                ;}}}
                                            }                           
        </script>

        <script>
            function show2(id) {

                var imgName2 = document.getElementById('imgName2');
                if (!id) {imgName2.innerHTML = "";
                } else {
                    for (var i = 0; i < eponyms.features.length; i++) {
                    if  (Number(id) === eponyms.features[i].ID) {
                        imgName2.innerHTML = eponyms.features[i].imgName
                                                ;}}}
                
                var msg2 = document.getElementById('msg2');
                if (!id) {msg2.innerHTML = "";
                } else {
                    for (var i = 0; i < eponyms.features.length; i++) {
                    if  (Number(id) === eponyms.features[i].ID) {
                        msg2.innerHTML = "<br>"+
                                        eponyms.features[i].who.bold()   +"<br>"+
                                        eponyms.features[i].when.bold()  +"<br>"+
                                        eponyms.features[i].where.bold() +"<br><br>"
                                                ;}}}
                                        
                var msg3 = document.getElementById('msg3');
                if (!id) {msg2.innerHTML = "";
                } else {
                    for (var i = 0; i < eponyms.features.length; i++) {
                    if  (Number(id) === eponyms.features[i].ID) {
                        msg3.innerHTML = 
                                        eponyms.features[i].about +
                                        eponyms.features[i].refs +
                                        eponyms.features[i].URLs +
                                        eponyms.features[i].acknow
                                                ;}}}                           
            }

        </script>

        <script src="/static/assets/js/theme.js"></script>

        <script>

            mapboxgl.accessToken = 'pk.eyJ1IjoiYWpoYXllczgzIiwiYSI6ImNrY2pqM2lvMDB4Z24ydG8zdDl0NTYwbTUifQ.2DKVfTAaE77XAXMpDeq_Pg';
          
            const bounds = [
                [-168.9, -60], //southwest coord  [-168.4, -66],
                [181, 80]  //northeast coord  [180, 85]
            ]


            const map = new mapboxgl.Map({
                container: 'map',
                style: 'mapbox://styles/mapbox/dark-v10',
                //https://api.mapbox.com/styles/v1/ajhayes83/ckvpe3wu534og14p36qyp9rf9.html?title=view&access_token=pk.eyJ1IjoiYWpoYXllczgzIiwiYSI6ImNrY2pqM2lvMDB4Z24ydG8zdDl0NTYwbTUifQ.2DKVfTAaE77XAXMpDeq_Pg&zoomwheel=true&fresh=true#5.96/51.711/-1.737
                //'mapbox://styles/mapbox/light-v10', //navigation-night-v1 //light-v10 //'/satellite-v9', //'dark-v10',//'mapbox://styles/maryshaffer/cjh6yf7c30apg2sotfzmyf2je',
                center: [-10, 90], //[10, 90],
                zoom: -8.0, //-0.52
                maxBounds: bounds,
            });
        
            // Add the control to the map.
            map.addControl(
                new MapboxGeocoder({
                    accessToken: mapboxgl.accessToken,
                    mapboxgl: mapboxgl,
                    })
            );
        
            map.addControl(new mapboxgl.FullscreenControl());
            map.addControl(new mapboxgl.NavigationControl());
           
            map.on('load', () => {
                // set the 'cluster' option to true. GL-JS will
                // add the point_count property to your source data.
                map.addSource('earthquakes', {
                    type: 'geojson',
                    data: eponyms,
                    cluster: true,
                    clusterMaxZoom: 12, // Max zoom to cluster points on
                    clusterRadius: 35 // Radius of each cluster when clustering points (defaults to 50)
                });
        
                map.addLayer({
                    id: 'clusters',
                    type: 'circle',
                    source: 'earthquakes',
                    filter: ['has', 'point_count'],
                    paint: {
                        // Use step expressions (https://docs.mapbox.com/mapbox-gl-js/style-spec/#expressions-step)
                        // with three steps to implement three types of circles:
                        //   * Blue, 20px circles when point count is less than 10
                        //   * Yellow, 30px circles when point count is between 10 and 20
                        //   * Pink, 40px circles when point count is greater than or equal to 20
                        'circle-color': [
                            'step',
                            ['get', 'point_count'],
                            '#FFFF00', //blue 51bbd6
                            10,
                            '#FFFF00', //yellow #f1f075
                            15,
                            '#FFFF00' //red f28cb1// yellow f1f075
                        ],
                        'circle-radius': [
                            'step',
                            ['get', 'point_count'],
                            10,  //radius 10 at 2-10  
                            10,  //2-10
                            14,  //radius 14 at 10-20
                            20,  //10-20
                            18,  //radius 18 at >20
                        ]
                    }
                });
        
                map.addLayer({
                    id: 'cluster-count',
                    type: 'symbol',
                    source: 'earthquakes',
                    filter: ['has', 'point_count'],
                    layout: {
                        'text-field': '{point_count_abbreviated}',
                        'text-font': ['DIN Offc Pro Medium', 'Arial Unicode MS Bold'],
                        'text-size': 11
                    }
                });
        
                map.addLayer({
                    id: 'unclustered-point',
                    type: 'circle',
                    source: 'earthquakes',
                    filter: ['!', ['has', 'point_count']],
                    paint: {
                        'circle-color': '#FFFF00', //blue 11b4da
                        'circle-radius': 8,
                        'circle-stroke-width': 1,
                        'circle-stroke-color': '#000000'//'#fff'
                    }
                });
        
                // inspect a cluster on click
                map.on('click', 'clusters', (e) => {
                    const features = map.queryRenderedFeatures(e.point, {
                        layers: ['clusters']
                    });
                    const clusterId = features[0].properties.cluster_id;
                    map.getSource('earthquakes').getClusterExpansionZoom(
                        clusterId,
                        (err, zoom) => {
                            if (err) return;
        
                            map.easeTo({
                                center: features[0].geometry.coordinates,
                                zoom: zoom
                            });
                        }
                    );
                });
        
                var popup = new mapboxgl.Popup({
                    closeOnClick: false,
                    offset: [0, -8]
                    })
        
                // When a click event occurs on a feature in
                // the unclustered-point layer, open a popup at
                // the location of the feature, with
                // description HTML from its properties.
                map.on('mouseenter', 'unclustered-point', (e) => {
        
                    map.getCanvas().style.cursor = 'pointer';
        
                    const coordinates = e.features[0].geometry.coordinates.slice();
                    const mag = e.features[0].properties.title;
                    const tsunami = e.features[0].properties.description;
        
                    // Ensure that if the map is zoomed out such that
                    // multiple copies of the feature are visible, the
                    // popup appears over the copy being pointed to.
                    while (Math.abs(e.lngLat.lng - coordinates[0]) > 180) {
                        coordinates[0] += e.lngLat.lng > coordinates[0] ? 360 : -360;
                    }
          
                    popup
                        .setLngLat(coordinates)
                        .setHTML(`${mag}<br>${tsunami}`)
                        .addTo(map);
                    });
                
                map.on('mouseleave', 'unclustered-point', (e) => {
                    map.getCanvas().style.cursor = '';
                    popup.remove()
                });
        
                map.on('mouseenter', 'clusters', () => {
                    map.getCanvas().style.cursor = 'pointer';
                });
                map.on('mouseleave', 'clusters', () => {
                    map.getCanvas().style.cursor = '';
                });
            });
        </script>

    </body>
</html>